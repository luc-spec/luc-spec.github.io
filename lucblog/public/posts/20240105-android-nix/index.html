<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>20240105 Android, Nix, and Even Some Education | Spec&#39;d Out</title>
<meta name="keywords" content="">
<meta name="description" content="I came across this guide that lays out how to start contributing to Gadgetbridge.
It&rsquo;s not Nix, it&rsquo;s me Since I&rsquo;m in the mode of playing around with shell.nix files, I immediately jumped to creating one for this project.
{ pkgs ? import &lt;nixpkgs&gt; {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = with pkgs.buildPackages; [ #android-studio androidStudioPackages.dev git openjdk17-bootstrap gradle_7 ]; } A quick switch, and we&rsquo;re off to the races, right?">
<meta name="author" content="">
<link rel="canonical" href="https://luc-spec.github.io/posts/20240105-android-nix/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.2d50b1531bd1b3146d65c5543bd298f7f982786aadee4c223cb3a1cb51906106.css" integrity="sha256-LVCxUxvRsxRtZcVUO9KY9/mCeGqt7kwiPLOhy1GQYQY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://luc-spec.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://luc-spec.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://luc-spec.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://luc-spec.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://luc-spec.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="20240105 Android, Nix, and Even Some Education" />
<meta property="og:description" content="I came across this guide that lays out how to start contributing to Gadgetbridge.
It&rsquo;s not Nix, it&rsquo;s me Since I&rsquo;m in the mode of playing around with shell.nix files, I immediately jumped to creating one for this project.
{ pkgs ? import &lt;nixpkgs&gt; {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = with pkgs.buildPackages; [ #android-studio androidStudioPackages.dev git openjdk17-bootstrap gradle_7 ]; } A quick switch, and we&rsquo;re off to the races, right?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://luc-spec.github.io/posts/20240105-android-nix/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T22:11:49-07:00" />
<meta property="article:modified_time" content="2024-01-05T22:11:49-07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="20240105 Android, Nix, and Even Some Education"/>
<meta name="twitter:description" content="I came across this guide that lays out how to start contributing to Gadgetbridge.
It&rsquo;s not Nix, it&rsquo;s me Since I&rsquo;m in the mode of playing around with shell.nix files, I immediately jumped to creating one for this project.
{ pkgs ? import &lt;nixpkgs&gt; {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = with pkgs.buildPackages; [ #android-studio androidStudioPackages.dev git openjdk17-bootstrap gradle_7 ]; } A quick switch, and we&rsquo;re off to the races, right?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://luc-spec.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "20240105 Android, Nix, and Even Some Education",
      "item": "https://luc-spec.github.io/posts/20240105-android-nix/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "20240105 Android, Nix, and Even Some Education",
  "name": "20240105 Android, Nix, and Even Some Education",
  "description": "I came across this guide that lays out how to start contributing to Gadgetbridge.\nIt\u0026rsquo;s not Nix, it\u0026rsquo;s me Since I\u0026rsquo;m in the mode of playing around with shell.nix files, I immediately jumped to creating one for this project.\n{ pkgs ? import \u0026lt;nixpkgs\u0026gt; {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = with pkgs.buildPackages; [ #android-studio androidStudioPackages.dev git openjdk17-bootstrap gradle_7 ]; } A quick switch, and we\u0026rsquo;re off to the races, right?",
  "keywords": [
    
  ],
  "articleBody": "I came across this guide that lays out how to start contributing to Gadgetbridge.\nIt’s not Nix, it’s me Since I’m in the mode of playing around with shell.nix files, I immediately jumped to creating one for this project.\n{ pkgs ? import {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = with pkgs.buildPackages; [ #android-studio androidStudioPackages.dev git openjdk17-bootstrap gradle_7 ]; } A quick switch, and we’re off to the races, right? Well, this spat out an… unhelpful error message.\n~$ nix-shell ~$ ./gradlew test Welcome to Gradle 7.5! Here are the highlights of this release: - Support for Java 18 - Support for building with Groovy 4 - Much more responsive continuous builds - Improved diagnostics for dependency resolution For more details see https://docs.gradle.org/7.5/release-notes.html Starting a Gradle Daemon, 1 stopped Daemon could not be reused, use --status for details FAILURE: Build failed with an exception. * What went wrong: A problem occurred configuring project ':app'. \u003e Multiple entries with same key: main=[] and main=[] * Try: \u003e Run with --stacktrace option to get the stack trace. \u003e Run with --info or --debug option to get more log output. \u003e Run with --scan to get full insights. * Get more help at https://help.gradle.org Deprecated Gradle features were used in this build, making it incompatible with Gradle 8.0. You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins. See https://docs.gradle.org/7.5/userguide/command_line_interface.html#sec:command_line_warnings BUILD FAILED in 10s ~$ ./gradlew test --info Initialized native services in: /home/luc/.gradle/native Initialized jansi services in: /home/luc/.gradle/native The client will now receive all logging from the daemon (pid: 606976). The daemon log file: /home/luc/.gradle/daemon/7.5/daemon-606976.out.log Starting 2nd build in daemon [uptime: 4 mins 39.89 secs, performance: 100%] Using 16 worker leases. Watching the file system is configured to be enabled if available File system watching is inactive Starting Build Settings evaluated using settings file '/home/luc/Repos/all/Gadgetbridge/settings.gradle'. Projects loaded. Root project using build file '/home/luc/Repos/all/Gadgetbridge/build.gradle'. Included projects: [root project 'Gadgetbridge', project ':app', project ':GBDaoGenerator'] \u003e Configure project : Evaluating root project 'Gadgetbridge' using build file '/home/luc/Repos/all/Gadgetbridge/build.gradle'. \u003e Configure project :app Evaluating project ':app' using build file '/home/luc/Repos/all/Gadgetbridge/app/build.gradle'. Using default execution profile The com.google.protobuf plugin was already applied to the project: :app and will not be applied again after plugin: android Starting process 'command 'git''. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD Successfully started process 'command 'git'' Starting process 'command 'git''. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD Successfully started process 'command 'git'' Starting process 'command 'git''. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD Successfully started process 'command 'git'' ------------------------------------------------------------------------ Detecting the operating system and CPU architecture ------------------------------------------------------------------------ os.detected.name=linux os.detected.arch=x86_64 os.detected.bitness=64 os.detected.version=6.6 os.detected.version.major=6 os.detected.version.minor=6 os.detected.release=fedora os.detected.release.version=39 os.detected.release.like.fedora=true os.detected.classifier=linux-x86_64 FAILURE: Build failed with an exception. * What went wrong: A problem occurred configuring project ':app'. \u003e Multiple entries with same key: main=[] and main=[] * Try: \u003e Run with --stacktrace option to get the stack trace. \u003e Run with --debug option to get more log output. \u003e Run with --scan to get full insights. * Get more help at https://help.gradle.org Deprecated Gradle features were used in this build, making it incompatible with Gradle 8.0. You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins. See https://docs.gradle.org/7.5/userguide/command_line_interface.html#sec:command_line_warnings BUILD FAILED in 1s After some more digging I was able to get everything working using the container approach!\nFROM android-30:latest COPY ./my/local/copy/of/Gadgetbridge /src # on the host podman build -t gadgetbridge . podman run --rm -ti localhost/gadgetbridge /bin/bash # in the container ~$ cd /src ~$ ./gradlew test ... [trimmed build output] ... BUILD SUCCESSFUL in 9m 30s 255 actionable tasks: 255 executed Not watching anything anymore Watching 0 directories to track changes Some of the file system contents retained in the virtual file system are on file systems that Gradle doesn't support watching. The relevant state was discarded to ensure changes to these locations are properly detected. You can override this by explicitly enabling file system watching. Watching 0 directories to track changes I still want to get a native build working; more work incoming!\n",
  "wordCount" : "696",
  "inLanguage": "en",
  "datePublished": "2024-01-05T22:11:49-07:00",
  "dateModified": "2024-01-05T22:11:49-07:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://luc-spec.github.io/posts/20240105-android-nix/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Spec'd Out",
    "logo": {
      "@type": "ImageObject",
      "url": "https://luc-spec.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://luc-spec.github.io/" accesskey="h" title="Spec&#39;d Out (Alt + H)">Spec&#39;d Out</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      20240105 Android, Nix, and Even Some Education
    </h1>
    <div class="post-meta"><span title='2024-01-05 22:11:49 -0700 MST'>January 5, 2024</span>

</div>
  </header> 
  <div class="post-content"><p>I came across <a href="https://gadgetbridge.org/internals/development/setup-environment/#installing-dependencies">this guide</a> that lays out how to start contributing to Gadgetbridge.</p>
<h2 id="its-not-nix-its-me">It&rsquo;s not Nix, it&rsquo;s me<a hidden class="anchor" aria-hidden="true" href="#its-not-nix-its-me">#</a></h2>
<p>Since I&rsquo;m in the mode of playing around with <code>shell.nix</code> files, I immediately jumped to creating one for this project.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nix" data-lang="nix"><span style="display:flex;"><span>{ pkgs <span style="color:#f92672">?</span> <span style="color:#f92672">import</span> <span style="color:#e6db74">&lt;nixpkgs&gt;</span> {} }:
</span></span><span style="display:flex;"><span>  pkgs<span style="color:#f92672">.</span>mkShell {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># nativeBuildInputs is usually what you want -- tools you need to run</span>
</span></span><span style="display:flex;"><span>    nativeBuildInputs <span style="color:#f92672">=</span> <span style="color:#66d9ef">with</span> pkgs<span style="color:#f92672">.</span>buildPackages; [
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#android-studio</span>
</span></span><span style="display:flex;"><span>      androidStudioPackages<span style="color:#f92672">.</span>dev
</span></span><span style="display:flex;"><span>      git
</span></span><span style="display:flex;"><span>      openjdk17-bootstrap
</span></span><span style="display:flex;"><span>      gradle_7
</span></span><span style="display:flex;"><span>    ];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>A quick switch, and we&rsquo;re off to the races, right? Well, this spat out an&hellip; unhelpful error message.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~$ nix-shell
</span></span><span style="display:flex;"><span>~$ ./gradlew test
</span></span><span style="display:flex;"><span>Welcome to Gradle 7.5!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Here are the highlights of this release:
</span></span><span style="display:flex;"><span> - Support <span style="color:#66d9ef">for</span> Java <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span> - Support <span style="color:#66d9ef">for</span> building with Groovy <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span> - Much more responsive continuous builds
</span></span><span style="display:flex;"><span> - Improved diagnostics <span style="color:#66d9ef">for</span> dependency resolution
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>For more details see https://docs.gradle.org/7.5/release-notes.html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting a Gradle Daemon, <span style="color:#ae81ff">1</span> stopped Daemon could not be reused, use --status <span style="color:#66d9ef">for</span> details
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FAILURE: Build failed with an exception.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* What went wrong:
</span></span><span style="display:flex;"><span>A problem occurred configuring project <span style="color:#e6db74">&#39;:app&#39;</span>.
</span></span><span style="display:flex;"><span>&gt; Multiple entries with same key: main<span style="color:#f92672">=[]</span> and main<span style="color:#f92672">=[]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Try:
</span></span><span style="display:flex;"><span>&gt; Run with --stacktrace option to get the stack trace.
</span></span><span style="display:flex;"><span>&gt; Run with --info or --debug option to get more log output.
</span></span><span style="display:flex;"><span>&gt; Run with --scan to get full insights.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Get more help at https://help.gradle.org
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deprecated Gradle features were used in this build, making it incompatible with Gradle 8.0.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You can use <span style="color:#e6db74">&#39;--warning-mode all&#39;</span> to show the individual deprecation warnings and determine <span style="color:#66d9ef">if</span> they come from your own scripts or plugins.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>See https://docs.gradle.org/7.5/userguide/command_line_interface.html#sec:command_line_warnings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILD FAILED in 10s
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~$ ./gradlew test --info
</span></span><span style="display:flex;"><span>Initialized native services in: /home/luc/.gradle/native
</span></span><span style="display:flex;"><span>Initialized jansi services in: /home/luc/.gradle/native
</span></span><span style="display:flex;"><span>The client will now receive all logging from the daemon <span style="color:#f92672">(</span>pid: 606976<span style="color:#f92672">)</span>. The daemon log file: /home/luc/.gradle/daemon/7.5/daemon-606976.out.log
</span></span><span style="display:flex;"><span>Starting 2nd build in daemon <span style="color:#f92672">[</span>uptime: <span style="color:#ae81ff">4</span> mins 39.89 secs, performance: 100%<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Using <span style="color:#ae81ff">16</span> worker leases.
</span></span><span style="display:flex;"><span>Watching the file system is configured to be enabled <span style="color:#66d9ef">if</span> available
</span></span><span style="display:flex;"><span>File system watching is inactive
</span></span><span style="display:flex;"><span>Starting Build
</span></span><span style="display:flex;"><span>Settings evaluated using settings file <span style="color:#e6db74">&#39;/home/luc/Repos/all/Gadgetbridge/settings.gradle&#39;</span>.
</span></span><span style="display:flex;"><span>Projects loaded. Root project using build file <span style="color:#e6db74">&#39;/home/luc/Repos/all/Gadgetbridge/build.gradle&#39;</span>.
</span></span><span style="display:flex;"><span>Included projects: <span style="color:#f92672">[</span>root project <span style="color:#e6db74">&#39;Gadgetbridge&#39;</span>, project <span style="color:#e6db74">&#39;:app&#39;</span>, project <span style="color:#e6db74">&#39;:GBDaoGenerator&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Configure project :
</span></span><span style="display:flex;"><span>Evaluating root project <span style="color:#e6db74">&#39;Gadgetbridge&#39;</span> using build file <span style="color:#e6db74">&#39;/home/luc/Repos/all/Gadgetbridge/build.gradle&#39;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Configure project :app
</span></span><span style="display:flex;"><span>Evaluating project <span style="color:#e6db74">&#39;:app&#39;</span> using build file <span style="color:#e6db74">&#39;/home/luc/Repos/all/Gadgetbridge/app/build.gradle&#39;</span>.
</span></span><span style="display:flex;"><span>Using default execution profile
</span></span><span style="display:flex;"><span>The com.google.protobuf plugin was already applied to the project: :app and will not be applied again after plugin: android
</span></span><span style="display:flex;"><span>Starting process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD
</span></span><span style="display:flex;"><span>Successfully started process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>Starting process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD
</span></span><span style="display:flex;"><span>Successfully started process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>Starting process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>. Working directory: /home/luc/Repos/all/Gadgetbridge/app Command: git rev-parse --short HEAD
</span></span><span style="display:flex;"><span>Successfully started process <span style="color:#e6db74">&#39;command &#39;</span>git<span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Detecting the operating system and CPU architecture
</span></span><span style="display:flex;"><span>------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>os.detected.name<span style="color:#f92672">=</span>linux
</span></span><span style="display:flex;"><span>os.detected.arch<span style="color:#f92672">=</span>x86_64
</span></span><span style="display:flex;"><span>os.detected.bitness<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>os.detected.version<span style="color:#f92672">=</span>6.6
</span></span><span style="display:flex;"><span>os.detected.version.major<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>os.detected.version.minor<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>os.detected.release<span style="color:#f92672">=</span>fedora
</span></span><span style="display:flex;"><span>os.detected.release.version<span style="color:#f92672">=</span><span style="color:#ae81ff">39</span>
</span></span><span style="display:flex;"><span>os.detected.release.like.fedora<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>os.detected.classifier<span style="color:#f92672">=</span>linux-x86_64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FAILURE: Build failed with an exception.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* What went wrong:
</span></span><span style="display:flex;"><span>A problem occurred configuring project <span style="color:#e6db74">&#39;:app&#39;</span>.
</span></span><span style="display:flex;"><span>&gt; Multiple entries with same key: main<span style="color:#f92672">=[]</span> and main<span style="color:#f92672">=[]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Try:
</span></span><span style="display:flex;"><span>&gt; Run with --stacktrace option to get the stack trace.
</span></span><span style="display:flex;"><span>&gt; Run with --debug option to get more log output.
</span></span><span style="display:flex;"><span>&gt; Run with --scan to get full insights.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* Get more help at https://help.gradle.org
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deprecated Gradle features were used in this build, making it incompatible with Gradle 8.0.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You can use <span style="color:#e6db74">&#39;--warning-mode all&#39;</span> to show the individual deprecation warnings and determine <span style="color:#66d9ef">if</span> they come from your own scripts or plugins.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>See https://docs.gradle.org/7.5/userguide/command_line_interface.html#sec:command_line_warnings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILD FAILED in 1s
</span></span></code></pre></div><p>After some more digging I was able to get everything working using the container approach!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> android-30:latest</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./my/local/copy/of/Gadgetbridge /src<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># on the host</span>
</span></span><span style="display:flex;"><span>podman build -t gadgetbridge .
</span></span><span style="display:flex;"><span>podman run --rm -ti localhost/gadgetbridge /bin/bash
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># in the container</span>
</span></span><span style="display:flex;"><span>~$ cd /src
</span></span><span style="display:flex;"><span>~$ ./gradlew test
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>trimmed build output<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>BUILD SUCCESSFUL in 9m 30s
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">255</span> actionable tasks: <span style="color:#ae81ff">255</span> executed
</span></span><span style="display:flex;"><span>Not watching anything anymore
</span></span><span style="display:flex;"><span>Watching <span style="color:#ae81ff">0</span> directories to track changes
</span></span><span style="display:flex;"><span>Some of the file system contents retained in the virtual file system are on file systems that Gradle doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t support watching. The relevant state was discarded to ensure changes to these locations are properly detected. You can override this by explicitly enabling file system watching.
</span></span><span style="display:flex;"><span>Watching <span style="color:#ae81ff">0</span> directories to track changes
</span></span></code></pre></div><p>I still want to get a native build working; more work incoming!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://luc-spec.github.io/">Spec&#39;d Out</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
